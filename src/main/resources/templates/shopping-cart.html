<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Meta Tags -->
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>

    <!-- Page Title -->
    <title>Coș de cumpărături | TooGoodToWaste</title>

    <!-- Favicon Image -->
    <link rel="icon" type="image/png" th:href="@{/images/assets/favicon.svg}"/>

    <!-- Libraries Stylesheet -->
    <link rel="stylesheet" th:href="@{/lib/css/swiper-bundle.min.css}"/>
    <link rel="stylesheet" th:href="@{/lib/css/bvselect.css}"/>
    <link rel="stylesheet" th:href="@{/lib/css/bootstrap.min.css}"/>
    <link rel="stylesheet" th:href="@{/css/style.css}"/>
</head>

<body>
<!-- Spinner Start -->
<div th:replace="~{/fragments/spinner :: spinner}"></div>
<!-- Spinner End -->

<!-- Shopping Cart Sidebar Start -->
<div th:replace="~{/fragments/shopping-cart-sidebar :: shoppingCartSidebar}"></div>
<!-- Shopping Cart Sidebar End -->

<!-- Header Section Start -->
<div th:replace="~{/fragments/header :: header}"></div>
<!-- Header Section End -->

<!-- Banner Section Start -->
<div class="section breedcrumb">
    <div class="breedcrumb__img-wrapper">
        <img th:src="@{/images/banner/main-banner.jpg}" alt="breedcrumb"/>
        <div class="container">
            <ul class="breedcrumb__content">
                <li>
                    <a th:href="@{index}">
                        <svg width="18" height="19" viewBox="0 0 18 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M1 8L9 1L17 8V18H12V14C12 13.2044 11.6839 12.4413 11.1213 11.8787C10.5587 11.3161 9.79565 11 9 11C8.20435 11 7.44129 11.3161 6.87868 11.8787C6.31607 12.4413 6 13.2044 6 14V18H1V8Z"
                                  stroke="#808080" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span>></span>
                    </a>
                </li>
                <li class="active"><a th:href="@{/shopping-cart}">Coș de cumpărături</a></li>
            </ul>
        </div>
    </div>
</div>
<!-- Banner Section End -->

<!-- Shopping Cart Section Start -->
<section class="shoping-cart section section--xl">
    <div class="container">
        <div class="row shoping-cart__content">
            <div class="col-lg-8">
                <div th:if="${#lists.isEmpty(cartItems)}" class="text-center font-body--md-500"
                     style="margin-top: 60px; font-size: 16px;">
                    <p>Nu sunt produse în coșul curent!</p>
                </div>
                <div class="cart-table" th:unless="${#lists.isEmpty(cartItems)}">
                    <div class="table-responsive">
                        <form th:action="@{/cart/update}" method="post">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th scope="col" class="cart-table-title">Product</th>
                                    <th scope="col" class="cart-table-title">Name</th>
                                    <th scope="col" class="cart-table-title">Price</th>
                                    <th scope="col" class="cart-table-title">Quantity</th>
                                    <th scope="col" class="cart-table-title">Subtotal</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="item : ${cartItems}">
                                    <!-- Product Item -->
                                    <td class="cart-table-item align-middle">
                                        <a
                                                th:href="@{/product-details(id=${item.productId})}"
                                                class="cart-table__product-item"
                                        >
                                            <div class="cart-table__product-item-img">
                                                <img
                                                        th:src="@{${item.productImage}}"
                                                        alt="product"
                                                />
                                            </div>
                                        </a>
                                    </td>
                                    <!-- Name -->
                                    <td class="cart-table-item align-middle">
                                        <h5 class="font-body--lg-400" th:text="${item.name}"></h5>
                                    </td>
                                    <!-- Price -->
                                    <td class="cart-table-item order-date align-middle"
                                        th:text="${item.finalPrice} + ' MDL'"></td>
                                    <!-- Quantity -->
                                    <td class="cart-table-item order-total align-middle">
                                        <form th:action="@{/cart/update}" method="post">
                                            <input type="hidden" name="itemId" th:value="${item.id}"/>
                                            <div class="counter-btn-wrapper">
                                                <button class="counter-btn-dec counter-btn" type="button"
                                                        onclick="decrement(this)"
                                                        onblur="this.parentElement.querySelector('input[type=number]').dispatchEvent(new Event('blur'))">-</button>
                                                <input type="number"
                                                       class="counter-btn-counter"
                                                       name="quantity"
                                                       th:value="${item.quantity}"
                                                       min="1"
                                                       th:attr="max=${item.totalQuantity}"
                                                       onblur="validateQuantity(this); this.form.submit();"/>
                                                <button class="counter-btn-inc counter-btn" type="button"
                                                        onclick="increment(this)"
                                                        onblur="this.parentElement.querySelector('input[type=number]').dispatchEvent(new Event('blur'))">+</button>
                                            </div>
                                        </form>
                                    </td>
                                    <!-- Subtotal -->
                                    <td class="cart-table-item order-subtotal align-middle">
                                        <div class="d-flex justify-content-between align-items-ce">
                                            <p class="font-body--md-500" th:text="${item.subtotal}"></p>
                                            <form th:action="@{/cart/remove/{itemId}(itemId=${item.id})}" method="post"
                                                  style="display:inline;">
                                                <button type="submit" class="delete-item" title="Șterge produsul"
                                                        style="position: relative; top: -3px;">
                                                    <svg
                                                            width="24"
                                                            height="25"
                                                            viewBox="0 0 24 25"
                                                            fill="none"
                                                            xmlns="http://www.w3.org/2000/svg"
                                                    >
                                                        <path
                                                                d="M12 23.5C18.0748 23.5 23 18.5748 23 12.5C23 6.42525 18.0748 1.5 12 1.5C5.92525 1.5 1 6.42525 1 12.5C1 18.5748 5.92525 23.5 12 23.5Z"
                                                                stroke="#CCCCCC"
                                                                stroke-miterlimit="10"
                                                        />
                                                        <path
                                                                d="M16 8.5L8 16.5"
                                                                stroke="#666666"
                                                                stroke-width="1.5"
                                                                stroke-linecap="round"
                                                                stroke-linejoin="round"
                                                        />
                                                        <path
                                                                d="M16 16.5L8 8.5"
                                                                stroke="#666666"
                                                                stroke-width="1.5"
                                                                stroke-linecap="round"
                                                                stroke-linejoin="round"
                                                        />
                                                    </svg>
                                                </button>
                                            </form>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </form>
                    </div>
                    <!-- Action Buttons -->
                    <div class="cart-table-action-btn d-flex">
                        <a th:href="@{/shop}" class="button button--md shop">Înapoi la magazin</a>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="bill-card">
                    <div class="bill-card__content">
                        <div class="bill-card__header">
                            <h2 class="bill-card__header-title font-body--xxl-500">
                                Rezumat comandă
                            </h2>
                        </div>
                        <div class="bill-card__body">
                            <div class="bill-card__memo">
                                <!-- Subtotal -->
                                <div class="bill-card__memo-item subtotal">
                                    <p class="font-body--md-400">Subtotal:</p>
                                    <span class="font-body--md-500" th:text="${cartTotal} + ' MDL'"></span>
                                </div>
                                <!-- Shipping -->
                                <div class="bill-card__memo-item shipping">
                                    <p class="font-body--md-400">Livrare:</p>
                                    <span class="font-body--md-500">Gratuit</span>
                                </div>
                                <!-- Total -->
                                <div class="bill-card__memo-item total">
                                    <p class="font-body--lg-400">Total:</p>
                                    <span class="font-body--xl-500" th:text="${cartTotal} + ' MDL'"></span>
                                </div>
                            </div>
                            <form action="#">
                                <button
                                        class="button button--lg w-100"
                                        style="margin-top: 20px"
                                        type="submit"
                                >
                                    Plasează comanda
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Shopping Cart Section Start -->

<!-- Cal-to-action Section Start -->
<div th:replace="~{/fragments/call-to-action :: callToActionSection}"></div>
<!-- Cal-to-action Section End -->

<!-- Footer Section Start -->
<div th:replace="~{/fragments/footer :: footer}"></div>
<!-- Footer Section End -->

<!-- JavaScript Libraries -->
<script th:src="@{/lib/js/jquery.min.js}"></script>
<script th:src="@{/lib/js/swiper-bundle.min.js}"></script>
<script th:src="@{/lib/js/bvselect.js}"></script>
<script th:src="@{/lib/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/js/main.js}"></script>
</body>

</html>